<svg viewBox="0 0 1400 1000" xmlns="http://www.w3.org/2000/svg">
  <!-- Couches -->
  <text x="10" y="30" font-size="18" font-weight="bold" fill="#333">PRESENTATION</text>
  <rect x="10" y="40" width="1380" height="100" fill="#e3f2fd" stroke="#1976d2" stroke-width="2"/>
  
  <text x="10" y="170" font-size="18" font-weight="bold" fill="#333">APPLICATION</text>
  <rect x="10" y="180" width="1380" height="150" fill="#fff3e0" stroke="#f57c00" stroke-width="2"/>
  
  <text x="10" y="360" font-size="18" font-weight="bold" fill="#333">DOMAIN</text>
  <rect x="10" y="370" width="1380" height="280" fill="#f3e5f5" stroke="#7b1fa2" stroke-width="2"/>
  
  <text x="10" y="680" font-size="18" font-weight="bold" fill="#333">INFRASTRUCTURE</text>
  <rect x="10" y="690" width="1380" height="280" fill="#e8f5e9" stroke="#388e3c" stroke-width="2"/>
  
  <!-- PRESENTATION Layer -->
  <rect x="550" y="60" width="250" height="60" fill="#fff" stroke="#1976d2" stroke-width="2"/>
  <text x="600" y="85" font-size="14" font-weight="bold">OrderPricingController</text>
  <text x="570" y="105" font-size="11">+ calculate(Request): JsonResponse</text>
  
  <!-- APPLICATION Layer -->
  <!-- Command DTO -->
  <rect x="50" y="200" width="280" height="100" fill="#fff" stroke="#f57c00" stroke-width="2"/>
  <text x="120" y="225" font-size="14" font-weight="bold">CalculateOrderPriceCommand</text>
  <text x="60" y="245" font-size="11">+ customerId: string</text>
  <text x="60" y="260" font-size="11">+ items: array</text>
  <text x="60" y="275" font-size="11">+ strategyCodes: array</text>
  <text x="60" y="290" font-size="11">&lt;&lt;DTO&gt;&gt;</text>
  
  <!-- Use Case Handler -->
  <rect x="400" y="200" width="320" height="100" fill="#fff" stroke="#f57c00" stroke-width="2"/>
  <text x="450" y="225" font-size="14" font-weight="bold">CalculateOrderPriceHandler</text>
  <text x="410" y="245" font-size="11">+ execute(Command): Response</text>
  <text x="410" y="265" font-size="11">Dependencies:</text>
  <text x="410" y="280" font-size="10">- CustomerRepository</text>
  <text x="410" y="292" font-size="10">- ProductRepository, StrategyRegistry</text>
  
  <!-- Response DTO -->
  <rect x="780" y="200" width="280" height="100" fill="#fff" stroke="#f57c00" stroke-width="2"/>
  <text x="850" y="225" font-size="14" font-weight="bold">CalculateOrderPriceResponse</text>
  <text x="790" y="245" font-size="11">+ subtotal: float</text>
  <text x="790" y="260" font-size="11">+ total: float</text>
  <text x="790" y="275" font-size="11">+ appliedStrategies: array</text>
  <text x="790" y="290" font-size="11">&lt;&lt;DTO&gt;&gt;</text>
  
  <!-- DOMAIN Layer -->
  <!-- Entities -->
  <rect x="30" y="390" width="150" height="80" fill="#fff" stroke="#7b1fa2" stroke-width="2"/>
  <text x="75" y="415" font-size="14" font-weight="bold">Customer</text>
  <text x="40" y="435" font-size="10">- id: UUID</text>
  <text x="40" y="448" font-size="10">- email: string</text>
  <text x="40" y="461" font-size="10">- type: CustomerType</text>
  
  <rect x="200" y="390" width="150" height="80" fill="#fff" stroke="#7b1fa2" stroke-width="2"/>
  <text x="245" y="415" font-size="14" font-weight="bold">Product</text>
  <text x="210" y="435" font-size="10">- id: UUID</text>
  <text x="210" y="448" font-size="10">- name: string</text>
  <text x="210" y="461" font-size="10">- price: float</text>
  
  <rect x="370" y="390" width="150" height="100" fill="#fff" stroke="#7b1fa2" stroke-width="2"/>
  <text x="420" y="415" font-size="14" font-weight="bold">Order</text>
  <text x="380" y="435" font-size="10">- id: UUID</text>
  <text x="380" y="448" font-size="10">- customer: Customer</text>
  <text x="380" y="461" font-size="10">- items: OrderItem[]</text>
  <text x="380" y="474" font-size="10">+ getSubtotal(): float</text>
  
  <rect x="540" y="390" width="150" height="80" fill="#fff" stroke="#7b1fa2" stroke-width="2"/>
  <text x="580" y="415" font-size="14" font-weight="bold">OrderItem</text>
  <text x="550" y="435" font-size="10">- product: Product</text>
  <text x="550" y="448" font-size="10">- quantity: int</text>
  <text x="550" y="461" font-size="10">- unitPrice: float</text>
  
  <rect x="710" y="390" width="180" height="80" fill="#fff" stroke="#7b1fa2" stroke-width="2"/>
  <text x="745" y="415" font-size="14" font-weight="bold">PromotionalEvent</text>
  <text x="720" y="435" font-size="10">- code: string</text>
  <text x="720" y="448" font-size="10">- discountPercentage: int</text>
  <text x="720" y="461" font-size="10">+ isActive(date): bool</text>
  
  <!-- Strategy Interface -->
  <rect x="370" y="520" width="250" height="80" fill="#fff" stroke="#7b1fa2" stroke-width="2"/>
  <text x="420" y="545" font-size="14" font-weight="bold">&lt;&lt;interface&gt;&gt;</text>
  <text x="410" y="565" font-size="14" font-weight="bold">PricingStrategyInterface</text>
  <text x="380" y="585" font-size="11">+ calculate(amount: float): float</text>
  
  <!-- Repository Interfaces -->
  <rect x="920" y="490" width="200" height="60" fill="#fff" stroke="#7b1fa2" stroke-width="2"/>
  <text x="950" y="515" font-size="12">&lt;&lt;interface&gt;&gt;</text>
  <text x="930" y="533" font-size="11">CustomerRepositoryInterface</text>
  
  <rect x="1140" y="490" width="200" height="60" fill="#fff" stroke="#7b1fa2" stroke-width="2"/>
  <text x="1170" y="515" font-size="12">&lt;&lt;interface&gt;&gt;</text>
  <text x="1150" y="533" font-size="11">ProductRepositoryInterface</text>
  
  <rect x="920" y="570" width="240" height="60" fill="#fff" stroke="#7b1fa2" stroke-width="2"/>
  <text x="945" y="595" font-size="12">&lt;&lt;interface&gt;&gt;</text>
  <text x="930" y="613" font-size="11">PromotionalEventRepositoryInterface</text>
  
  <!-- INFRASTRUCTURE Layer -->
  <!-- Concrete Strategies -->
  <rect x="30" y="710" width="150" height="60" fill="#fff" stroke="#388e3c" stroke-width="2"/>
  <text x="50" y="735" font-size="13" font-weight="bold">VipPricingStrategy</text>
  <text x="40" y="755" font-size="10">+ calculate(float): float</text>
  
  <rect x="200" y="710" width="170" height="60" fill="#fff" stroke="#388e3c" stroke-width="2"/>
  <text x="210" y="735" font-size="13" font-weight="bold">StudentPricingStrategy</text>
  <text x="210" y="755" font-size="10">+ calculate(float): float</text>
  
  <rect x="390" y="710" width="170" height="60" fill="#fff" stroke="#388e3c" stroke-width="2"/>
  <text x="400" y="735" font-size="13" font-weight="bold">StandardPricingStrategy</text>
  <text x="400" y="755" font-size="10">+ calculate(float): float</text>
  
  <rect x="30" y="800" width="200" height="80" fill="#fff" stroke="#388e3c" stroke-width="2"/>
  <text x="50" y="825" font-size="13" font-weight="bold">EventBasedPricingStrategy</text>
  <text x="40" y="845" font-size="10">- event: PromotionalEvent</text>
  <text x="40" y="858" font-size="10">- currentDate: DateTime</text>
  <text x="40" y="871" font-size="10">+ calculate(float): float</text>
  
  <!-- Strategy Registry -->
  <rect x="350" y="820" width="280" height="100" fill="#fff" stroke="#388e3c" stroke-width="2"/>
  <text x="430" y="845" font-size="14" font-weight="bold">StrategyRegistry</text>
  <text x="360" y="865" font-size="11">+ get(code: string): Strategy</text>
  <text x="360" y="885" font-size="10">Dependencies:</text>
  <text x="360" y="900" font-size="9">- PromotionalEventRepository</text>
  
  <!-- Repositories -->
  <rect x="920" y="710" width="200" height="60" fill="#fff" stroke="#388e3c" stroke-width="2"/>
  <text x="960" y="735" font-size="13" font-weight="bold">CustomerRepository</text>
  <text x="930" y="755" font-size="10">+ find(id): Customer</text>
  
  <rect x="1140" y="710" width="200" height="60" fill="#fff" stroke="#388e3c" stroke-width="2"/>
  <text x="1180" y="735" font-size="13" font-weight="bold">ProductRepository</text>
  <text x="1150" y="755" font-size="10">+ find(id): Product</text>
  
  <rect x="920" y="800" width="240" height="60" fill="#fff" stroke="#388e3c" stroke-width="2"/>
  <text x="950" y="825" font-size="13" font-weight="bold">PromotionalEventRepository</text>
  <text x="930" y="845" font-size="10">+ findByCode(code): Event</text>
  
  <!-- Arrows -->
  <!-- Controller -> Handler -->
  <line x1="675" y1="120" x2="560" y2="200" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- Handler -> Repos (interfaces) -->
  <line x1="720" y1="250" x2="920" y2="520" stroke="#333" stroke-width="1" stroke-dasharray="5,5"/>
  <line x1="720" y1="250" x2="1140" y2="520" stroke="#333" stroke-width="1" stroke-dasharray="5,5"/>
  
  <!-- Handler -> Registry -->
  <line x1="560" y1="300" x2="490" y2="820" stroke="#333" stroke-width="2"/>
  
  <!-- Registry -> Event Repo Interface -->
  <line x1="630" y1="870" x2="920" y2="600" stroke="#333" stroke-width="1" stroke-dasharray="5,5"/>
  
  <!-- Strategies implement Interface -->
  <line x1="105" y1="710" x2="445" y2="600" stroke="#333" stroke-width="2" stroke-dasharray="5,5" marker-end="url(#triangle)"/>
  <line x1="285" y1="710" x2="470" y2="600" stroke="#333" stroke-width="2" stroke-dasharray="5,5" marker-end="url(#triangle)"/>
  <line x1="475" y1="710" x2="495" y2="600" stroke="#333" stroke-width="2" stroke-dasharray="5,5" marker-end="url(#triangle)"/>
  <line x1="130" y1="800" x2="420" y2="600" stroke="#333" stroke-width="2" stroke-dasharray="5,5" marker-end="url(#triangle)"/>
  
  <!-- Repos implement Interfaces -->
  <line x1="1020" y1="710" x2="1020" y2="550" stroke="#333" stroke-width="2" stroke-dasharray="5,5" marker-end="url(#triangle)"/>
  <line x1="1240" y1="710" x2="1240" y2="550" stroke="#333" stroke-width="2" stroke-dasharray="5,5" marker-end="url(#triangle)"/>
  <line x1="1040" y1="800" x2="1040" y2="630" stroke="#333" stroke-width="2" stroke-dasharray="5,5" marker-end="url(#triangle)"/>
  
  <!-- Markers -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#333"/>
    </marker>
    <marker id="triangle" markerWidth="10" markerHeight="10" refX="0" refY="3" orient="auto">
      <polygon points="0 3, 10 0, 10 6" fill="none" stroke="#333" stroke-width="1"/>
    </marker>
  </defs>
  
  <!-- Legend -->
  <text x="1150" y="960" font-size="12" font-weight="bold">Légende:</text>
  <line x1="1150" y1="970" x2="1200" y2="970" stroke="#333" stroke-width="2"/>
  <text x="1210" y="975" font-size="10">Dépendance</text>
  <line x1="1150" y1="985" x2="1200" y2="985" stroke="#333" stroke-width="2" stroke-dasharray="5,5"/>
  <text x="1210" y="990" font-size="10">Implémente</text>
</svg>